import{u as W,y as X,p as n,ck as Y,cl as Z,g as ee,j as e,ap as se,c9 as w,Q as j}from"./index-f981d823.js";import{B as te}from"./Bundle-ce039579.js";function re(){const{id:S}=W(),J=X(),[d,O]=n.useState([]),[C,z]=n.useState(""),[N,q]=n.useState(""),[f,Q]=n.useState(0),[_,k]=n.useState(0),[K,P]=n.useState(0),[o,v]=n.useState([]),[c,u]=n.useState([{title:"",description:""}]),[i,m]=n.useState([{question:"",answer:""}]),[h,E]=n.useState(!1),[F,B]=n.useState(0),[D,I]=n.useState(0),{data:b}=Y(S),s=n.useMemo(()=>(b==null?void 0:b.data)||{},[b]),[H,{isLoading:A}]=Z(),{data:y}=ee(),g=(y==null?void 0:y.data)||[];n.useEffect(()=>{var a,r,l;s&&(q((s==null?void 0:s.name)||""),Q((s==null?void 0:s.price)||0),k((s==null?void 0:s.discount)||0),P((s==null?void 0:s.stock)||0),z(s!=null&&s.image?`https://api.torayvinobd.store/${s.image}`:""),v(((a=s==null?void 0:s.products)==null?void 0:a.map(t=>t._id||t))||[]),u(((r=s==null?void 0:s.specifications)==null?void 0:r.length)>0?s.specifications:[{title:"",description:""}]),m(((l=s==null?void 0:s.faq)==null?void 0:l.length)>0?s.faq:[{question:"",answer:""}]),E((s==null?void 0:s.isBundle)||!1),B((s==null?void 0:s.bundlePurchaseQuantity)||0),I((s==null?void 0:s.bundleQuantity)||0))},[s]);const V=async a=>{var x,U,$,G,L,M,R,T;if(a.preventDefault(),!N)return j.warning("Name is required");if(!f)return j.warning("Price is required");const r={name:N,price:f,discount:_,stock:K,products:o,specifications:c.filter(p=>p.title&&p.description),faq:i.filter(p=>p.question&&p.answer),isBundle:h,bundlePurchaseQuantity:h?F:0,bundleQuantity:h?D:0},l=new FormData;(d==null?void 0:d.length)>0&&l.append("image",(x=d[0])==null?void 0:x.file),l.append("data",JSON.stringify(r));const t=await H({id:S,formData:l});(U=t==null?void 0:t.data)!=null&&U.success?(j.success("Kit updated successfully"),J("/admin/kit/all-kits")):(j.error(((L=(G=($=t==null?void 0:t.error)==null?void 0:$.data)==null?void 0:G.error)==null?void 0:L.length)>0?(T=(R=(M=t==null?void 0:t.error)==null?void 0:M.data)==null?void 0:R.error[0])==null?void 0:T.message:"Failed to update kit"),console.log(t))};return e.jsxs("div",{className:"edit_kit rounded bg-base-100 shadow",children:[e.jsx("h3",{className:"border-b p-4 text-lg font-medium text-neutral",children:"Edit Kit (GKK)"}),e.jsxs("div",{className:"p-3 text-neutral-content",children:[e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Kit Image"}),e.jsx(se,{value:d,onChange:a=>O(a),dataURLKey:"data_url",children:({onImageUpload:a,onImageRemove:r,dragProps:l})=>e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",...l,children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 rounded border border-dashed p-3",children:[e.jsx("span",{onClick:a,className:"cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose New Image"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop here"})]}),e.jsx("div",{className:"rounded border border-dashed p-3",children:(d==null?void 0:d.length)>0?e.jsx("div",{className:"grid gap-4 lg:grid-cols-3",children:d.map((t,x)=>e.jsxs("div",{className:"image-item relative",children:[e.jsx("img",{src:t.data_url,alt:"kit",className:"h-20 w-full object-cover rounded"}),e.jsx("div",{onClick:()=>r(x),className:"absolute right-0 top-0 flex h-7 w-7 cursor-pointer items-center justify-center rounded-full bg-primary text-base-100",children:e.jsx(w,{})})]},x))}):C?e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:C,alt:"Current",className:"h-16 w-16 rounded object-cover"}),e.jsx("span",{className:"text-sm text-neutral-content",children:"Current Image"})]})}):e.jsx("p",{className:"text-center text-gray-400",children:"No image selected"})})]})})]}),e.jsxs("div",{className:"form_group mt-3",children:[e.jsx("div",{className:"mt-3 rounded border p-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Kit Name"}),e.jsx("input",{type:"text",value:N,onChange:a=>q(a.target.value),placeholder:"Enter kit name",className:"w-full rounded border p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Price (à§³)"}),e.jsx("input",{type:"number",value:f,onChange:a=>Q(Number(a.target.value)),placeholder:"Enter price",className:"w-full rounded border p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Discount (%)"}),e.jsx("input",{type:"number",value:_,onChange:a=>k(Number(a.target.value)),placeholder:"Enter discount percentage",min:"0",max:"100",className:"w-full rounded border p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Stock Quantity"}),e.jsx("input",{type:"number",value:K,onChange:a=>P(Number(a.target.value)),placeholder:"Enter stock quantity",min:"0",className:"w-full rounded border p-2"})]})]})}),e.jsx(te,{isBundle:h,setIsBundle:E,bundlePurchaseQuantity:F,setBundlePurchaseQuantity:B,bundleQuantity:D,setBundleQuantity:I}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Related Products"}),e.jsxs("span",{className:"rounded bg-gray-100 px-2 py-1 text-xs text-gray-500",children:[o.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto rounded-lg border bg-gray-50 p-3",children:(g==null?void 0:g.length)>0?e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:g.map(a=>e.jsxs("div",{className:"flex items-center rounded border bg-white p-2 transition-colors hover:bg-purple-50",children:[e.jsx("input",{type:"checkbox",id:`product-${a._id}`,checked:o.includes(a._id),onChange:r=>{r.target.checked?v([...o,a._id]):v(o.filter(l=>l!==a._id))},className:"mr-3 h-4 w-4 rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),e.jsx("label",{htmlFor:`product-${a._id}`,className:"flex-1 cursor-pointer text-sm text-gray-700",children:a.title})]},a._id))}):e.jsx("p",{className:"py-8 text-center text-gray-500",children:"No products available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Specifications"}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{className:"mb-1 ml-2 block w-[48%] text-sm font-medium text-gray-700",children:"Title"}),e.jsx("label",{className:"mb-1 block w-[50%] text-sm font-medium text-gray-700",children:"Description"})]}),c.map((a,r)=>e.jsxs("div",{className:"mb-3 flex gap-3 rounded border p-3",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{children:e.jsx("textarea",{placeholder:"Specification Title",value:a.title,onChange:l=>{const t=[...c];t[r].title=l.target.value,u(t)},className:"w-full rounded border p-2",rows:2})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:"Specification Description",value:a.description,onChange:l=>{const t=[...c];t[r].description=l.target.value,u(t)},className:"w-full rounded border p-2",rows:2})})]}),e.jsx("button",{type:"button",onClick:()=>{u(c.filter((l,t)=>t!==r))},className:"text-red-500 hover:text-red-700",children:e.jsx(w,{className:"h-7 w-7"})})]},r)),e.jsx("button",{type:"button",onClick:()=>u([...c,{title:"",description:""}]),className:"mt-2 rounded bg-blue-500 px-3 py-1 text-white",children:"Add Specification"})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"FAQ"}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{className:"mb-1 ml-2 block w-[48%] text-sm font-medium text-gray-700",children:"Question"}),e.jsx("label",{className:"mb-1 block w-[50%] text-sm font-medium text-gray-700",children:"Answer"})]}),i.map((a,r)=>e.jsxs("div",{className:"mb-3 flex gap-3 rounded border p-3",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{children:e.jsx("textarea",{placeholder:"Question",value:a.question,onChange:l=>{const t=[...i];t[r].question=l.target.value,m(t)},className:"w-full rounded border p-2",rows:2})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:"Answer",value:a.answer,onChange:l=>{const t=[...i];t[r].answer=l.target.value,m(t)},className:"w-full rounded border p-2",rows:2})})]}),e.jsx("button",{type:"button",onClick:()=>{m(i.filter((l,t)=>t!==r))},className:"text-red-500 hover:text-red-700",children:e.jsx(w,{className:"h-7 w-7"})})]},r)),e.jsx("button",{type:"button",onClick:()=>m([...i,{question:"",answer:""}]),className:"mt-2 rounded bg-blue-500 px-3 py-1 text-white",children:"Add FAQ"})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:V,type:"submit",disabled:A,className:"rounded bg-primary px-10 py-2 text-base-100",children:A?"Loading...":"Update Kit"})})]})]})]})}export{re as default};
