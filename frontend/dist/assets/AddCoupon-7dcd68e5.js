import{v as G,m as l,c as R,j as e,cI as z,Q as S}from"./index-3d958e2c.js";import{d as B}from"./couponApi-59686a6a.js";function K(){const C=G(),[L,{isLoading:d}]=B(),[r,A]=l.useState(!1),[i,D]=l.useState(0),[n,E]=l.useState(!1),[o,k]=l.useState([]),{data:c}=R({}),q=c==null?void 0:c.data;console.log("productIds: ",o);const T=async a=>{var u,m,p,x,f,h,g,j,N,b,v,y,w;a.preventDefault();const s=a.target,P=s.code.value,I=s.minimumShopping.value,U=s.discount.value,M=s.startDate.value,F=s.startTime.value,Q=s.endDate.value,_=s.endTime.value,$={code:P,minimumShopping:Number(I),isUsageLimit:r,usageLimit:Number(i),usageCount:0,availableCount:Number(i),discount:Number(U),startDate:M,startTime:F,endDate:Q,endTime:_,isActive:!0,isProduct:!!n,productIds:o},t=await L($);(u=t==null?void 0:t.data)!=null&&u.success?(S.success("Coupon add success"),s.reset(),C("/admin/ecommerce-setting/coupons")):(S.error(Array.isArray((p=(m=t==null?void 0:t.error)==null?void 0:m.data)==null?void 0:p.error)&&((f=(x=t==null?void 0:t.error)==null?void 0:x.data)==null?void 0:f.error.length)>0?`${((j=(g=(h=t==null?void 0:t.error)==null?void 0:h.data)==null?void 0:g.error[0])==null?void 0:j.path)||""} ${((v=(b=(N=t==null?void 0:t.error)==null?void 0:N.data)==null?void 0:b.error[0])==null?void 0:v.message)||""}`.trim():((w=(y=t==null?void 0:t.error)==null?void 0:y.data)==null?void 0:w.message)||"Something went wrong!"),console.log(t))};return e.jsxs("section",{className:"rounded bg-base-100 shadow md:w-[600px]",children:[e.jsx("div",{className:"border-b p-4 font-medium text-neutral",children:e.jsx("h3",{children:"Add New Coupon"})}),e.jsxs("form",{onSubmit:T,className:"p-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Coupon code"}),e.jsx("input",{type:"text",name:"code",placeholder:"Enter Code",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Minimum Shopping"}),e.jsx("input",{type:"number",name:"minimumShopping",placeholder:"Enter Minimum Shopping Ammount",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Discount (%)"}),e.jsx("input",{type:"number",name:"discount",placeholder:"Enter Discount %",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Usage Limit"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Enable if this item has a usage limit"})]}),e.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[e.jsx("input",{type:"checkbox",className:"peer sr-only",checked:r,onChange:()=>A(!r)}),e.jsx("div",{className:"peer h-6 w-11 rounded-full bg-gray-300 after:absolute after:left-1 after:top-1 after:h-4 after:w-4 after:rounded-full after:bg-white after:transition-all peer-checked:bg-primary peer-checked:after:translate-x-full"})]})]}),r&&e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Usage Limit"}),e.jsx("input",{type:"number",name:"usageLimit",value:i,onChange:a=>D(Number(a.target.value)),placeholder:"Enter Usage Limit",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between bg-white p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Product Specific"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Enable if this coupon is specific to certain products"})]}),e.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[e.jsx("input",{type:"checkbox",className:"peer sr-only",checked:n,onChange:()=>E(!n)}),e.jsx("div",{className:"peer h-6 w-11 rounded-full bg-gray-300 after:absolute after:left-1 after:top-1 after:h-4 after:w-4 after:rounded-full after:bg-white after:transition-all peer-checked:bg-primary peer-checked:after:translate-x-full"})]})]}),n&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:"Products"}),e.jsx(z,{multi:!0,options:q,labelField:"title",valueField:"title",onChange:a=>k(a.map(s=>s._id)),values:o})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Start Time"}),e.jsx("input",{type:"time",name:"startTime",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"End Time"}),e.jsx("input",{type:"time",name:"endTime",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]})]}),e.jsx("div",{className:"mt-6 flex justify-end border-t p-4",children:e.jsx("button",{disabled:d&&"disabled",className:"primary_btn",children:d?"Loading...":"Add Coupon"})})]})]})}export{K as default};
