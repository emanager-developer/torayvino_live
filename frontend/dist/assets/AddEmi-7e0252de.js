import{m as P,v as q,cW as I,j as e,am as F,an as $,ci as U,cX as J,Q as c}from"./index-e0eec1b4.js";function Q(){const[n,B]=P.useState([]),[l,x]=P.useState([{months:3,chargePercentage:0}]),L=q(),[D,{isLoading:u}]=I(),R=()=>{x([...l,{months:6,chargePercentage:0}])},S=t=>{l.length>1&&x(l.filter((s,r)=>r!==t))},p=(t,s,r)=>{const d=l.map((o,i)=>i===t?{...o,[s]:parseFloat(r)||0}:o);x(d)},_=async t=>{var h,g,b,f,j,N,v,y,k,E,w,A,C,O,M;t.preventDefault();const s=(h=n[0])==null?void 0:h.file;if(!s)return c.error("Please select a bank logo");const d=t.target.bankName.value;if(!d.trim())return c.error("Please enter bank name");if(l.some(m=>m.months<=0||m.chargePercentage<0))return c.error("Please enter valid EMI options");const o={bankName:d.trim(),emiOptions:l.filter(m=>m.months>0)},i=new FormData;i.append("emi",s),i.append("data",JSON.stringify(o));const a=await D(i);(g=a==null?void 0:a.data)!=null&&g.success?(c.success(((b=a==null?void 0:a.data)==null?void 0:b.message)||"Bank added successfully"),L("/admin/ecommerce-setting/emi/all")):(c.error(Array.isArray((j=(f=a==null?void 0:a.error)==null?void 0:f.data)==null?void 0:j.error)&&((v=(N=a==null?void 0:a.error)==null?void 0:N.data)==null?void 0:v.error.length)>0?`${((E=(k=(y=a==null?void 0:a.error)==null?void 0:y.data)==null?void 0:k.error[0])==null?void 0:E.path)||""} ${((C=(A=(w=a==null?void 0:a.error)==null?void 0:w.data)==null?void 0:A.error[0])==null?void 0:C.message)||""}`.trim():((M=(O=a==null?void 0:a.error)==null?void 0:O.data)==null?void 0:M.message)||"Something went wrong!"),console.log(a))};return e.jsxs("section",{className:"rounded bg-base-100 shadow xl:w-[700px]",children:[e.jsx("div",{className:"border-b p-4 font-medium text-neutral",children:e.jsx("h3",{children:"Add Bank EMI"})}),e.jsxs("form",{onSubmit:_,className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"pb-2 text-sm font-medium text-neutral",children:"Bank Logo (Required)"}),e.jsx("p",{className:"pb-1 text-xs text-neutral-content",children:"Upload bank logo image"}),e.jsx(F,{value:n,onChange:t=>B(t),dataURLKey:"data_url",children:({onImageUpload:t,onImageRemove:s,dragProps:r})=>e.jsxs("div",{className:"w-max rounded border border-dashed p-4",...r,children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 sm:flex-row",children:[e.jsx("span",{onClick:t,className:"cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose Bank Logo"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop here"})]}),e.jsx("div",{className:`${(n==null?void 0:n.length)>0&&"mt-4"} `,children:n==null?void 0:n.map((d,o)=>e.jsxs("div",{className:"image-item relative",children:[e.jsx("img",{src:d.data_url,alt:"",className:"w-32 h-20 object-contain rounded border"}),e.jsx("div",{onClick:()=>s(o),className:"absolute right-0 top-0 flex h-7 w-7 cursor-pointer items-center justify-center rounded-full bg-primary text-base-100",children:e.jsx($,{})})]},o))})]})})]}),e.jsxs("div",{className:"mb-4 flex flex-col gap-1",children:[e.jsx("p",{className:"text-neutral-content",children:"Bank Name *"}),e.jsx("input",{type:"text",name:"bankName",placeholder:"Enter Bank Name",className:"w-full rounded border px-3 py-2 text-sm outline-none",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-neutral",children:"EMI Options *"}),e.jsxs("button",{type:"button",onClick:R,className:"flex items-center gap-1 text-sm text-primary hover:text-primary-focus",children:[e.jsx(U,{})," Add Option"]})]}),l.map((t,s)=>e.jsxs("div",{className:"flex gap-3 items-center mb-3 p-3 border rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-neutral-content mb-1",children:"Months"}),e.jsx("input",{type:"number",placeholder:"Months",className:"w-full rounded border px-3 py-2 text-sm outline-none",value:t.months,onChange:r=>p(s,"months",r.target.value),min:"1",max:"60",required:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-neutral-content mb-1",children:"Charge Percentage (%)"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Charge %",className:"w-full rounded border px-3 py-2 text-sm outline-none",value:t.chargePercentage,onChange:r=>p(s,"chargePercentage",r.target.value),min:"0",max:"100",required:!0})]}),e.jsx("button",{type:"button",onClick:()=>S(s),className:"text-red-500 hover:text-red-700 p-2 disabled:opacity-50",disabled:l.length===1,children:e.jsx(J,{})})]},s))]}),e.jsx("div",{className:"mt-6 flex justify-end border-t p-4",children:e.jsx("button",{disabled:u&&"disabled",className:"primary_btn",children:u?"Loading...":"Add Bank EMI"})})]})]})}export{Q as default};
