import{e as F,a as I,c as H,b as G,u as T,d as q,f as D,g as R,j as l,S as _,L as E,h as Q,N as U,A as X,i as Y,P as J}from"./index-f981d823.js";function M(C){return C===void 0&&(C=""),`.${C.trim().replace(/([\.:!+\/])/g,"\\$1").replace(/ /g,".")}`}function K(C){let{swiper:e,extendParams:z,on:u,emit:b}=C;const p="swiper-pagination";z({pagination:{el:null,bulletElement:"span",clickable:!1,hideOnClick:!1,renderBullet:null,renderProgressbar:null,renderFraction:null,renderCustom:null,progressbarOpposite:!1,type:"bullets",dynamicBullets:!1,dynamicMainBullets:1,formatFractionCurrent:a=>a,formatFractionTotal:a=>a,bulletClass:`${p}-bullet`,bulletActiveClass:`${p}-bullet-active`,modifierClass:`${p}-`,currentClass:`${p}-current`,totalClass:`${p}-total`,hiddenClass:`${p}-hidden`,progressbarFillClass:`${p}-progressbar-fill`,progressbarOppositeClass:`${p}-progressbar-opposite`,clickableClass:`${p}-clickable`,lockClass:`${p}-lock`,horizontalClass:`${p}-horizontal`,verticalClass:`${p}-vertical`,paginationDisabledClass:`${p}-disabled`}}),e.pagination={el:null,bullets:[]};let $,x=0;const n=a=>(Array.isArray(a)?a:[a]).filter(s=>!!s);function B(){return!e.params.pagination.el||!e.pagination.el||Array.isArray(e.pagination.el)&&e.pagination.el.length===0}function k(a,s){const{bulletActiveClass:t}=e.params.pagination;a&&(a=a[`${s==="prev"?"previous":"next"}ElementSibling`],a&&(a.classList.add(`${t}-${s}`),a=a[`${s==="prev"?"previous":"next"}ElementSibling`],a&&a.classList.add(`${t}-${s}-${s}`)))}function P(a){const s=a.target.closest(M(e.params.pagination.bulletClass));if(!s)return;a.preventDefault();const t=I(s)*e.params.slidesPerGroup;if(e.params.loop){if(e.realIndex===t)return;e.slideToLoop(t)}else e.slideTo(t)}function y(){const a=e.rtl,s=e.params.pagination;if(B())return;let t=e.pagination.el;t=n(t);let i,f;const L=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.slides.length,O=e.params.loop?Math.ceil(L/e.params.slidesPerGroup):e.snapGrid.length;if(e.params.loop?(f=e.previousRealIndex||0,i=e.params.slidesPerGroup>1?Math.floor(e.realIndex/e.params.slidesPerGroup):e.realIndex):typeof e.snapIndex<"u"?(i=e.snapIndex,f=e.previousSnapIndex):(f=e.previousIndex||0,i=e.activeIndex||0),s.type==="bullets"&&e.pagination.bullets&&e.pagination.bullets.length>0){const r=e.pagination.bullets;let v,g,w;if(s.dynamicBullets&&($=F(r[0],e.isHorizontal()?"width":"height",!0),t.forEach(o=>{o.style[e.isHorizontal()?"width":"height"]=`${$*(s.dynamicMainBullets+4)}px`}),s.dynamicMainBullets>1&&f!==void 0&&(x+=i-(f||0),x>s.dynamicMainBullets-1?x=s.dynamicMainBullets-1:x<0&&(x=0)),v=Math.max(i-x,0),g=v+(Math.min(r.length,s.dynamicMainBullets)-1),w=(g+v)/2),r.forEach(o=>{const d=[...["","-next","-next-next","-prev","-prev-prev","-main"].map(m=>`${s.bulletActiveClass}${m}`)].map(m=>typeof m=="string"&&m.includes(" ")?m.split(" "):m).flat();o.classList.remove(...d)}),t.length>1)r.forEach(o=>{const d=I(o);d===i?o.classList.add(...s.bulletActiveClass.split(" ")):e.isElement&&o.setAttribute("part","bullet"),s.dynamicBullets&&(d>=v&&d<=g&&o.classList.add(...`${s.bulletActiveClass}-main`.split(" ")),d===v&&k(o,"prev"),d===g&&k(o,"next"))});else{const o=r[i];if(o&&o.classList.add(...s.bulletActiveClass.split(" ")),e.isElement&&r.forEach((d,m)=>{d.setAttribute("part",m===i?"bullet-active":"bullet")}),s.dynamicBullets){const d=r[v],m=r[g];for(let j=v;j<=g;j+=1)r[j]&&r[j].classList.add(...`${s.bulletActiveClass}-main`.split(" "));k(d,"prev"),k(m,"next")}}if(s.dynamicBullets){const o=Math.min(r.length,s.dynamicMainBullets+4),d=($*o-$)/2-w*$,m=a?"right":"left";r.forEach(j=>{j.style[e.isHorizontal()?m:"top"]=`${d}px`})}}t.forEach((r,v)=>{if(s.type==="fraction"&&(r.querySelectorAll(M(s.currentClass)).forEach(g=>{g.textContent=s.formatFractionCurrent(i+1)}),r.querySelectorAll(M(s.totalClass)).forEach(g=>{g.textContent=s.formatFractionTotal(O)})),s.type==="progressbar"){let g;s.progressbarOpposite?g=e.isHorizontal()?"vertical":"horizontal":g=e.isHorizontal()?"horizontal":"vertical";const w=(i+1)/O;let o=1,d=1;g==="horizontal"?o=w:d=w,r.querySelectorAll(M(s.progressbarFillClass)).forEach(m=>{m.style.transform=`translate3d(0,0,0) scaleX(${o}) scaleY(${d})`,m.style.transitionDuration=`${e.params.speed}ms`})}s.type==="custom"&&s.renderCustom?(r.innerHTML=s.renderCustom(e,i+1,O),v===0&&b("paginationRender",r)):(v===0&&b("paginationRender",r),b("paginationUpdate",r)),e.params.watchOverflow&&e.enabled&&r.classList[e.isLocked?"add":"remove"](s.lockClass)})}function c(){const a=e.params.pagination;if(B())return;const s=e.virtual&&e.params.virtual.enabled?e.virtual.slides.length:e.grid&&e.params.grid.rows>1?e.slides.length/Math.ceil(e.params.grid.rows):e.slides.length;let t=e.pagination.el;t=n(t);let i="";if(a.type==="bullets"){let f=e.params.loop?Math.ceil(s/e.params.slidesPerGroup):e.snapGrid.length;e.params.freeMode&&e.params.freeMode.enabled&&f>s&&(f=s);for(let L=0;L<f;L+=1)a.renderBullet?i+=a.renderBullet.call(e,L,a.bulletClass):i+=`<${a.bulletElement} ${e.isElement?'part="bullet"':""} class="${a.bulletClass}"></${a.bulletElement}>`}a.type==="fraction"&&(a.renderFraction?i=a.renderFraction.call(e,a.currentClass,a.totalClass):i=`<span class="${a.currentClass}"></span> / <span class="${a.totalClass}"></span>`),a.type==="progressbar"&&(a.renderProgressbar?i=a.renderProgressbar.call(e,a.progressbarFillClass):i=`<span class="${a.progressbarFillClass}"></span>`),e.pagination.bullets=[],t.forEach(f=>{a.type!=="custom"&&(f.innerHTML=i||""),a.type==="bullets"&&e.pagination.bullets.push(...f.querySelectorAll(M(a.bulletClass)))}),a.type!=="custom"&&b("paginationRender",t[0])}function h(){e.params.pagination=H(e,e.originalParams.pagination,e.params.pagination,{el:"swiper-pagination"});const a=e.params.pagination;if(!a.el)return;let s;typeof a.el=="string"&&e.isElement&&(s=e.el.querySelector(a.el)),!s&&typeof a.el=="string"&&(s=[...document.querySelectorAll(a.el)]),s||(s=a.el),!(!s||s.length===0)&&(e.params.uniqueNavElements&&typeof a.el=="string"&&Array.isArray(s)&&s.length>1&&(s=[...e.el.querySelectorAll(a.el)],s.length>1&&(s=s.filter(t=>G(t,".swiper")[0]===e.el)[0])),Array.isArray(s)&&s.length===1&&(s=s[0]),Object.assign(e.pagination,{el:s}),s=n(s),s.forEach(t=>{a.type==="bullets"&&a.clickable&&t.classList.add(...(a.clickableClass||"").split(" ")),t.classList.add(a.modifierClass+a.type),t.classList.add(e.isHorizontal()?a.horizontalClass:a.verticalClass),a.type==="bullets"&&a.dynamicBullets&&(t.classList.add(`${a.modifierClass}${a.type}-dynamic`),x=0,a.dynamicMainBullets<1&&(a.dynamicMainBullets=1)),a.type==="progressbar"&&a.progressbarOpposite&&t.classList.add(a.progressbarOppositeClass),a.clickable&&t.addEventListener("click",P),e.enabled||t.classList.add(a.lockClass)}))}function A(){const a=e.params.pagination;if(B())return;let s=e.pagination.el;s&&(s=n(s),s.forEach(t=>{t.classList.remove(a.hiddenClass),t.classList.remove(a.modifierClass+a.type),t.classList.remove(e.isHorizontal()?a.horizontalClass:a.verticalClass),a.clickable&&(t.classList.remove(...(a.clickableClass||"").split(" ")),t.removeEventListener("click",P))})),e.pagination.bullets&&e.pagination.bullets.forEach(t=>t.classList.remove(...a.bulletActiveClass.split(" ")))}u("changeDirection",()=>{if(!e.pagination||!e.pagination.el)return;const a=e.params.pagination;let{el:s}=e.pagination;s=n(s),s.forEach(t=>{t.classList.remove(a.horizontalClass,a.verticalClass),t.classList.add(e.isHorizontal()?a.horizontalClass:a.verticalClass)})}),u("init",()=>{e.params.pagination.enabled===!1?N():(h(),c(),y())}),u("activeIndexChange",()=>{typeof e.snapIndex>"u"&&y()}),u("snapIndexChange",()=>{y()}),u("snapGridLengthChange",()=>{c(),y()}),u("destroy",()=>{A()}),u("enable disable",()=>{let{el:a}=e.pagination;a&&(a=n(a),a.forEach(s=>s.classList[e.enabled?"remove":"add"](e.params.pagination.lockClass)))}),u("lock unlock",()=>{y()}),u("click",(a,s)=>{const t=s.target,i=n(e.pagination.el);if(e.params.pagination.el&&e.params.pagination.hideOnClick&&i&&i.length>0&&!t.classList.contains(e.params.pagination.bulletClass)){if(e.navigation&&(e.navigation.nextEl&&t===e.navigation.nextEl||e.navigation.prevEl&&t===e.navigation.prevEl))return;const f=i[0].classList.contains(e.params.pagination.hiddenClass);b(f===!0?"paginationShow":"paginationHide"),i.forEach(L=>L.classList.toggle(e.params.pagination.hiddenClass))}});const S=()=>{e.el.classList.remove(e.params.pagination.paginationDisabledClass);let{el:a}=e.pagination;a&&(a=n(a),a.forEach(s=>s.classList.remove(e.params.pagination.paginationDisabledClass))),h(),c(),y()},N=()=>{e.el.classList.add(e.params.pagination.paginationDisabledClass);let{el:a}=e.pagination;a&&(a=n(a),a.forEach(s=>s.classList.add(e.params.pagination.paginationDisabledClass))),A()};Object.assign(e.pagination,{enable:S,disable:N,render:c,update:y,init:h,destroy:A})}function W(){var S,N;const{slug:C}=T(),{data:e,isLoading:z,isError:u}=q(C,{skip:!C}),{data:b,isLoading:p,isError:$}=D(C,{skip:!u&&!!(e!=null&&e.data)}),{data:x}=R({limit:100}),n=(e==null?void 0:e.data)||(b==null?void 0:b.data),B=(x==null?void 0:x.data)||[],k=z||p,P=u&&$;if(k)return l.jsx(_,{});if(P||!n)return l.jsx("section",{className:"px-4 py-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-primary mb-4",children:"Offer not found"}),l.jsx("p",{className:"text-gray-600 mb-2",children:"The requested offer does not exist or has been removed."}),l.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Please make sure the offer URL is correct and the offer is still active."}),l.jsx(E,{to:"/offers",className:"text-white bg-primary px-4 py-2 rounded hover:bg-primary-dark transition-colors",children:"Back to offers"})]})});const y=B.filter(a=>{var s;return(s=n.products)==null?void 0:s.some(t=>typeof t=="string"?t===a._id:t._id===a._id)}),c=((S=n.banners)==null?void 0:S.desktop)||[],h=((N=n.banners)==null?void 0:N.mobile)||[],A=c.length>0||h.length>0;return l.jsxs("section",{children:[A?l.jsx("div",{className:"",children:l.jsx(Q,{modules:[U,X,K],navigation:Math.max(c.length,h.length)>1,pagination:Math.max(c.length,h.length)>1?{clickable:!0}:!1,autoplay:{delay:5e3,disableOnInteraction:!1},loop:Math.max(c.length,h.length)>1,speed:1e3,className:"hero-swiper mySwiper h-full w-full",children:Array.from({length:Math.max(c.length,h.length)}).map((a,s)=>l.jsxs(Y,{children:[c[s]&&l.jsx("img",{src:`https://api.torayvinobd.store${c[s]}`,alt:`${n.name} desktop banner ${s+1}`,className:"h-full w-full hidden sm:block ",loading:"lazy",onError:t=>{t.target.onerror=null,t.target.src="/images/default-banner.jpg"}}),l.jsx("img",{src:`https://api.torayvinobd.store${h[s]||c[s]||c[0]}`,alt:`${n.name} mobile banner ${s+1}`,className:"h-full w-full block sm:hidden ",loading:"lazy",onError:t=>{h[s]&&t.target.src.includes(h[s])?t.target.src=`https://api.torayvinobd.store${c[s]||c[0]}`:(t.target.onerror=null,t.target.src="/images/default-banner.jpg")}})]},`slide-${s}`))})}):l.jsx("div",{className:"h-64 md:h-96 bg-gradient-to-r from-primary to-secondary flex items-center justify-center",children:l.jsxs("div",{className:"text-white text-center px-4",children:[l.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-4",children:n.name}),l.jsx("p",{className:"text-lg md:text-xl mb-4",children:n.description}),n.discountPercentage&&l.jsxs("div",{className:"bg-red-500 text-white px-6 py-3 rounded-full inline-block font-bold text-xl",children:[n.discountPercentage,"% OFF"]})]})}),l.jsx("div",{className:"px-4 py-8",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsxs("div",{className:"mb-8 text-center",children:[l.jsx("h1",{className:"text-4xl font-bold text-primary mb-4",children:n.name}),l.jsx("p",{className:"text-gray-600 text-lg max-w-3xl mx-auto mb-6",children:n.description})]}),y.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-3xl font-semibold mb-8 text-center",children:"Featured Products in this Offer"}),l.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3",children:y.map(a=>l.jsx(J,{product:a,discount:n.discountPercentage||0},a._id))})]}),l.jsx("div",{className:"text-center",children:l.jsx(E,{to:"/offers",className:"inline-block text-white bg-primary px-6 py-3 rounded-lg hover:bg-primary-dark transition-colors",children:"‚Üê Back to All Offers"})})]})})]})}export{W as default};
