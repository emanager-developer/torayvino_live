import{u as Re,v as ze,m as r,cf as He,c6 as Ue,c7 as Ke,W as Le,c8 as Je,cg as We,j as e,c9 as Be,Q as m}from"./index-e0eec1b4.js";import{T as Oe,G as Xe,P as Ye,a as Ze,V as es,F as ss,D as ts}from"./Details-391ea0b3.js";import{B as as}from"./Bundle-6542c6a6.js";import"./brandApi-0d2f38fd.js";import"./subCategoryApi-bd4044ab.js";import"./subSubCategoryApi-0a57cf9e.js";import"./colorApi-e9d19ee9.js";function ms(){var Ce,ke;const{id:Y}=Re(),Z=ze(),[ee,se]=r.useState([]),[g,Me]=r.useState([]),[te,ae]=r.useState([]),[c,B]=r.useState([]),[M,le]=r.useState(""),[T,re]=r.useState(null),[$,ne]=r.useState(null),[I,ie]=r.useState(null),[de,ce]=r.useState(null),[E,V]=r.useState(0),[G,R]=r.useState(0),[Te,oe]=r.useState(0),[me,ue]=r.useState(!1),[z,xe]=r.useState(""),[u,he]=r.useState(""),[b,ge]=r.useState(!1),[o,be]=r.useState([]),[f,$e]=r.useState([]),[x,p]=r.useState([{title:"",description:""}]),[j,H]=r.useState([]),[y,U]=r.useState([]),[h,N]=r.useState([{question:"",answer:""}]),[fe,pe]=r.useState(""),[v,K]=r.useState([]),[P,je]=r.useState(!1),[ye,Ne]=r.useState(0),[ve,we]=r.useState(0),{data:F}=He(Y),s=r.useMemo(()=>(F==null?void 0:F.data)||{},[F]),{data:L}=Ue(),{data:J}=Ke(),{data:W}=Le(),{data:q}=Je(),Q=(L==null?void 0:L.data)||[],A=(J==null?void 0:J.data)||[],D=(W==null?void 0:W.data)||[],O=r.useMemo(()=>{const t=((q==null?void 0:q.data)||[]).map(l=>l==null?void 0:l.name).filter(Boolean),n=new Set([...t||[],...u?[u]:[]]);return Array.from(n)},[q,u]);r.useEffect(()=>{var t,n,l,a,w,S,C,k,_;s&&(se(s!=null&&s.thumbnail?[{data_url:`https://api.torayvinobd.store/${s.thumbnail}`}]:[]),ae(s==null?void 0:s.galleries),le((s==null?void 0:s.title)||""),ne(((t=s==null?void 0:s.category)==null?void 0:t._id)??(s==null?void 0:s.category)??""),ie(((n=s==null?void 0:s.subCategory)==null?void 0:n._id)??(s==null?void 0:s.subCategory)??""),re(((l=s==null?void 0:s.subSubCategory)==null?void 0:l._id)??(s==null?void 0:s.subSubCategory)??""),ce((s==null?void 0:s.brand)||null),V((s==null?void 0:s.price)||0),R((s==null?void 0:s.stock)||0),oe((s==null?void 0:s.discount)||0),ue((s==null?void 0:s.featured)||!1),xe((s==null?void 0:s.description)||""),he(Array.isArray(s==null?void 0:s.tags)?((a=s.tags)==null?void 0:a[0])||"":typeof(s==null?void 0:s.tags)=="string"&&s.tags.split(";").map(i=>i.trim()).filter(Boolean)[0]||""),ge((s==null?void 0:s.isVariant)||!1),be((s==null?void 0:s.variants)||[]),p(((w=s==null?void 0:s.specifications)==null?void 0:w.length)>0?s.specifications:[{title:"",description:""}]),H(((S=s==null?void 0:s.feature)==null?void 0:S.map(i=>i._id||i))||[]),U(((C=s==null?void 0:s.shortFeature)==null?void 0:C.map(i=>i._id||i))||[]),N(((k=s==null?void 0:s.faq)==null?void 0:k.length)>0?s.faq:[{question:"",answer:""}]),pe((s==null?void 0:s.disclaimer)||""),K(((_=s==null?void 0:s.kits)==null?void 0:_.map(i=>i._id||i))||[]),je((s==null?void 0:s.isBundle)||!1),Ne((s==null?void 0:s.bundlePurchaseQuantity)||0),we((s==null?void 0:s.bundleQuantity)||0),s!=null&&s.productManual&&B([{name:"Current Manual",url:`https://api.torayvinobd.store${s.productManual}`}]))},[s]),r.useEffect(()=>{var t;b&&(o==null?void 0:o.length)>0&&(V(((t=o[0])==null?void 0:t.price)||0),R(o==null?void 0:o.reduce((n,l)=>n+(Number(l.stock)||0),0)))},[b,o]);const[Ie,{isLoading:Se}]=We(),Ee=async t=>{var w,S,C,k,_,i,_e,Pe,Fe,qe,Qe,Ae,De;if(t.preventDefault(),!M)return m.warning("Title is required");if(!$)return m.warning("Category is required");if(!E)return m.warning("Price is required");if(!G)return m.warning("Stock is required");if(!z)return m.warning("Description is required");const n={title:M,brand:de,price:E,stock:G,discount:Te,featured:me,description:z,isVariant:b,variants:o,tags:u?[u]:[],galleriesUrl:te,specifications:x.filter(d=>d.title&&d.description),feature:j,shortFeature:y,faq:h.filter(d=>d.question&&d.answer),disclaimer:fe,kits:v,isBundle:P,bundlePurchaseQuantity:P?ye:0,bundleQuantity:P?ve:0};n.category=$,I&&(n.subCategory=I),T&&(n.subSubCategory=T);const l=new FormData;l.append("thumbnail",(w=ee[0])==null?void 0:w.file),(g==null?void 0:g.length)>0&&g.forEach(d=>l.append("gallery",d.file)),(c==null?void 0:c.length)>0&&((S=c[0])!=null&&S.file)&&l.append("productManual",(C=c[0])==null?void 0:C.file),(f==null?void 0:f.length)>0&&f.forEach((d,Ve)=>{if((d==null?void 0:d.length)>0){const X=d[0].file,Ge=new File([X],`variant-${Ve}-${X.name}`,{type:X.type});l.append("variantImages",Ge)}}),l.append("data",JSON.stringify(n));const a=await Ie({id:Y,formData:l});(k=a==null?void 0:a.data)!=null&&k.success?(m.success("Product updated successfully"),Z("/admin/product/all-products")):(m.error(`${((Pe=(_e=(i=(_=a==null?void 0:a.error)==null?void 0:_.data)==null?void 0:i.error)==null?void 0:_e[0])==null?void 0:Pe.message)||((Qe=(qe=(Fe=a==null?void 0:a.error)==null?void 0:Fe.data)==null?void 0:qe.error)==null?void 0:Qe.message)||((De=(Ae=a==null?void 0:a.error)==null?void 0:Ae.data)==null?void 0:De.message)||"Something went wrong!"}`),console.log(a))};return e.jsxs("div",{className:"add_product rounded bg-base-100 shadow",children:[e.jsx("h3",{className:"border-b p-4 text-lg font-medium text-neutral",children:"Edit Product"}),e.jsxs("div",{className:"p-3 text-neutral-content",children:[e.jsx(Oe,{thumbnail:ee,setThumbnail:se}),e.jsx(Xe,{galleries:g,setGalleries:Me,galleriesUrl:te,setGalleriesUrl:ae}),e.jsxs("div",{className:"form_group mt-3",children:[e.jsx(Ye,{title:M,setTitle:le,categoryId:$,setCategoryId:ne,subCategoryId:I,setSubCategoryId:ie,subSubCategoryId:T,setSubSubCategoryId:re,brand:de,setBrand:ce}),e.jsx(Ze,{price:E,setPrice:V,setDiscount:oe,stock:G,setStock:R,isVariant:b}),e.jsx(es,{isVariant:b,setIsVariant:ge,variants:o,setVariants:be,variantImages:f,setVariantImages:$e}),e.jsx(ss,{featured:me,setFeatured:ue}),e.jsx(as,{isBundle:P,setIsBundle:je,bundlePurchaseQuantity:ye,setBundlePurchaseQuantity:Ne,bundleQuantity:ve,setBundleQuantity:we}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("label",{className:"mb-2 block text-sm",children:["Tags ",e.jsx("small",{children:"(select from Tag list)"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("select",{value:u,onChange:t=>he(t.target.value),className:"w-full rounded border p-2",children:[e.jsx("option",{value:"",children:"Select a tag"}),O==null?void 0:O.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 text-xs text-neutral-content",children:[e.jsx("span",{children:"Select one tag for badge."}),e.jsx("button",{type:"button",onClick:()=>Z("/admin/tags"),className:"rounded bg-primary px-3 py-1 text-base-100",children:"Manage Tags"})]})]})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("p",{className:"mb-2 text-sm",children:"Product Manual (PDF)"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 rounded border border-dashed p-3",children:[e.jsx("input",{type:"file",accept:".pdf",onChange:t=>{t.target.files&&t.target.files[0]&&B([{file:t.target.files[0],name:t.target.files[0].name}])},className:"hidden",id:"pdf-upload"}),e.jsx("label",{htmlFor:"pdf-upload",className:"cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose PDF File"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop PDF here"})]}),e.jsx("div",{className:"rounded border border-dashed p-3",children:(c==null?void 0:c.length)>0?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-6 w-6 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-neutral-content",children:(Ce=c[0])==null?void 0:Ce.name})]}),e.jsxs("div",{className:"flex gap-2",children:[((ke=c[0])==null?void 0:ke.url)&&e.jsx("a",{href:c[0].url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:e.jsxs("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),e.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),e.jsx("button",{type:"button",onClick:()=>B([]),className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}):e.jsx("p",{className:"text-center text-gray-400",children:"No PDF selected"})})]})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Features"}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[j.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg p-3 bg-gray-50",children:(Q==null?void 0:Q.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Q.map(t=>e.jsxs("div",{className:"flex items-center p-2 bg-white rounded border hover:bg-blue-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:`feature-${t._id}`,checked:j.includes(t._id),onChange:n=>{n.target.checked?H([...j,t._id]):H(j.filter(l=>l!==t._id))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mr-3"}),e.jsx("label",{htmlFor:`feature-${t._id}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t.name||t.title})]},t._id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No features available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Short Features"}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[y.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg p-3 bg-gray-50",children:(A==null?void 0:A.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:A.map(t=>e.jsxs("div",{className:"flex items-center p-2 bg-white rounded border hover:bg-green-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:`shortFeature-${t._id}`,checked:y.includes(t._id),onChange:n=>{n.target.checked?U([...y,t._id]):U(y.filter(l=>l!==t._id))},className:"h-4 w-4 text-green-600 border-gray-300 rounded focus:ring-green-500 mr-3"}),e.jsx("label",{htmlFor:`shortFeature-${t._id}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t.name||t.title})]},t._id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No short features available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Related Kits"}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[v.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg p-3 bg-gray-50",children:(D==null?void 0:D.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:D.map(t=>e.jsxs("div",{className:"flex items-center p-2 bg-white rounded border hover:bg-purple-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:`kit-${t._id}`,checked:v.includes(t._id),onChange:n=>{n.target.checked?K([...v,t._id]):K(v.filter(l=>l!==t._id))},className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500 mr-3"}),e.jsx("label",{htmlFor:`kit-${t._id}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t.name})]},t._id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No kits available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Specifications"}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{className:"mb-1 ml-2 block w-[48%] text-sm font-medium text-gray-700",children:"Title"}),e.jsx("label",{className:"mb-1 block w-[50%] text-sm font-medium text-gray-700",children:"Description"})]}),x.map((t,n)=>e.jsxs("div",{className:"mb-3 flex gap-3 rounded border p-3",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{children:e.jsx("textarea",{placeholder:"Specification Title",value:t.title,onChange:l=>{const a=[...x];a[n].title=l.target.value,p(a)},className:"w-full rounded border p-2",rows:2})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:"Specification Description",value:t.description,onChange:l=>{const a=[...x];a[n].description=l.target.value,p(a)},className:"w-full rounded border p-2",rows:2})})]}),e.jsx("button",{type:"button",onClick:()=>{p(x.filter((l,a)=>a!==n))},className:"text-red-500 hover:text-red-700",children:e.jsx(Be,{className:"h-7 w-7"})})]},n)),e.jsx("button",{type:"button",onClick:()=>p([...x,{title:"",description:""}]),className:"mt-2 rounded bg-blue-500 px-3 py-1 text-white",children:"Add Specification"})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"FAQ"}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{className:"mb-1 ml-2 block w-[48%] text-sm font-medium text-gray-700",children:"Question"}),e.jsx("label",{className:"mb-1 block w-[50%] text-sm font-medium text-gray-700",children:"Answer"})]}),h.map((t,n)=>e.jsxs("div",{className:"mb-3 flex gap-3 rounded border p-3",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{children:e.jsx("textarea",{placeholder:"Question",value:t.question,onChange:l=>{const a=[...h];a[n].question=l.target.value,N(a)},className:"w-full rounded border p-2",rows:2})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:"Answer",value:t.answer,onChange:l=>{const a=[...h];a[n].answer=l.target.value,N(a)},className:"w-full rounded border p-2",rows:2})})]}),e.jsx("button",{type:"button",onClick:()=>{N(h.filter((l,a)=>a!==n))},className:"text-red-500 hover:text-red-700",children:e.jsx(Be,{className:"h-7 w-7"})})]},n)),e.jsx("button",{type:"button",onClick:()=>N([...h,{question:"",answer:""}]),className:"mt-2 rounded bg-blue-500 px-3 py-1 text-white",children:"Add FAQ"})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Disclaimer"}),e.jsx("textarea",{value:fe,onChange:t=>pe(t.target.value),placeholder:"Enter product disclaimer",className:"w-full rounded border p-2",rows:4})]}),e.jsx(ts,{details:z,setDetails:xe}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:Ee,type:"submit",disabled:Se,className:"rounded bg-primary px-10 py-2 text-base-100",children:Se?"Loading...":"Edit Product"})})]})]})]})}export{ms as default};
