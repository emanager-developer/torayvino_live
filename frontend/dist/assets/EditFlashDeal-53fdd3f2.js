import{u as w,y as V,p as c,g as _,j as e,cI as q,Q as N}from"./index-f981d823.js";import{d as L,e as C}from"./flashDeal-4c52b3c5.js";function G(){var j,b,g;const{id:m}=w(),y=V(),{data:a,isLoading:v}=L(m),[i,o]=c.useState([]);c.useEffect(()=>{var s,t,r,n;((t=(s=a==null?void 0:a.data)==null?void 0:s.flashProducts)==null?void 0:t.length)>0&&o((n=(r=a==null?void 0:a.data)==null?void 0:r.flashProducts)==null?void 0:n.map(l=>l==null?void 0:l.product))},[a]);const{data:h}=_(),D=h==null?void 0:h.data,[F,u]=c.useState([]),[P,{isLoading:f}]=C();c.useEffect(()=>{var s,t,r;((t=(s=a==null?void 0:a.data)==null?void 0:s.flashProducts)==null?void 0:t.length)>0&&u((r=a==null?void 0:a.data)==null?void 0:r.flashProducts)},[a]);const E=(s,t,r)=>{u(n=>{var x;const l=[...n];return l[s]||(l[s]=[]),l[s]={...l[s],product:(x=i[s])==null?void 0:x._id,[t]:r},l})},S=async s=>{var p;s.preventDefault();const t=s.target,r=t.title.value,n=t.startDate.value,l=t.endDate.value,d=await P({id:m,data:{title:r,startDate:n,endDate:l,flashProducts:F}});(p=d==null?void 0:d.data)!=null&&p.success?(N.success("Flash Deal updated successfully"),o([]),t.reset(),u([]),y("/admin/flash-deal")):(N.error("Failed to update flash deal"),console.log(d))};return v?e.jsx("p",{children:"Loading..."}):e.jsxs("section",{className:"rounded bg-base-100 p-3 text-neutral",children:[e.jsx("p",{children:"Flash Deal Information"}),e.jsxs("form",{onSubmit:S,className:"mx-auto mt-6 flex flex-col gap-4 text-sm xl:w-2/3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:"Title"}),e.jsx("input",{type:"text",className:"rounded border px-4 py-1 outline-none",name:"title",defaultValue:(j=a==null?void 0:a.data)==null?void 0:j.title,required:!0})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:"Start Date"}),e.jsx("input",{type:"date",className:"rounded border px-4 py-1 outline-none",name:"startDate",defaultValue:(b=a==null?void 0:a.data)==null?void 0:b.startDate,required:!0})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:"End Date"}),e.jsx("input",{type:"date",className:"rounded border px-4 py-1 outline-none",name:"endDate",defaultValue:(g=a==null?void 0:a.data)==null?void 0:g.endDate,required:!0})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:"Products"}),e.jsx(q,{multi:!0,options:D,labelField:"title",valueField:"_id",onChange:s=>o(s),values:i})]}),(i==null?void 0:i.length)>0&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("p",{children:"Discounts"}),e.jsx("div",{className:"relative overflow-x-auto shadow-lg",children:e.jsxs("table",{className:"dashboard_table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-b border-r bg-gray-100",children:"Product"}),e.jsx("th",{className:"border-b border-r bg-gray-100",children:"Base Price"}),e.jsx("th",{className:"border-b border-r bg-gray-100",children:"Discount"}),e.jsx("th",{className:"border-b bg-gray-100",children:"Discount Type"})]})}),e.jsx("tbody",{children:i==null?void 0:i.map((s,t)=>{var r,n;return e.jsxs("tr",{children:[e.jsx("td",{className:"border-r",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:`https://api.torayvinobd.store/products/${s==null?void 0:s.thumbnail}`,alt:"",className:"h-8 w-8 rounded"}),e.jsx("p",{children:s==null?void 0:s.title})]})}),e.jsx("td",{className:"border-r",children:e.jsx("p",{children:s==null?void 0:s.sellingPrice})}),e.jsx("td",{className:"border-r",children:e.jsx("input",{type:"number",className:"w-28 rounded border px-4 py-1 outline-none",onChange:l=>E(t,"discount",l.target.value),required:!0,defaultValue:(n=(r=a==null?void 0:a.data)==null?void 0:r.flashProducts[t])==null?void 0:n.discount})}),e.jsx("td",{children:e.jsx("input",{type:"text",defaultValue:"%",disabled:!0,className:"bg-base-100"})})]},s==null?void 0:s._id)})})]})})]}),e.jsx("div",{children:e.jsx("button",{disabled:f&&"disabled",className:"primary_btn",children:f?"Loading...":"Save"})})]})]})}export{G as default};
