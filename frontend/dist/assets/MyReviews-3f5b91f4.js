import{m,l as A,j as s,H as S,J as D,K as P,Q as g}from"./index-3d958e2c.js";import{b as k,a as F,R as I}from"./reviewApi-8f1b041f.js";import{R as Q}from"./ReviewEditForm-8e84c44c.js";function H(){var p,h,j;const[R,u]=m.useState(!1),{loggedCustomer:n}=A(t=>t.customer),[r,N]=m.useState(1),o={};o.limit=5,o.page=r,o.customer=n==null?void 0:n._id;const{data:e}=k(o),[b]=F(),x=Math.ceil(parseInt((p=e==null?void 0:e.meta)==null?void 0:p.total)/parseInt((h=e==null?void 0:e.meta)==null?void 0:h.limit)),y=async t=>{var l,c,f;if(!window.confirm("Are you sure you want to delete this review?"))return;const d={customer:n==null?void 0:n._id},a=await b({reviewId:t,data:d});(l=a==null?void 0:a.data)!=null&&l.success?g.success("Review deleted successfully"):(g.error(((f=(c=a==null?void 0:a.error)==null?void 0:c.data)==null?void 0:f.message)||"Failed to delete review"),console.log(a))},[E,M]=m.useState({}),_=t=>{M(t),u(!0)};return s.jsxs("div",{children:[s.jsx("div",{className:"mb-3 border-b pb-1",children:s.jsx("h3",{children:"All Reviews"})}),s.jsxs("div",{className:"flex flex-col gap-2",children:[(j=e==null?void 0:e.data)==null?void 0:j.map(t=>{var i,d,a,l,c;return s.jsxs("div",{className:"relative border-b p-3",children:[s.jsxs("div",{className:"flex items-center gap-5",children:[s.jsx("img",{src:((i=t==null?void 0:t.user)==null?void 0:i.image)===""||((d=t==null?void 0:t.user)==null?void 0:d.image)===null?"/images/demo_user.jpg":`https://api.torayvinobd.store/user/${(a=t==null?void 0:t.user)==null?void 0:a.image}`,alt:"",className:"h-9 w-9 rounded-full"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("p",{children:(l=t==null?void 0:t.user)==null?void 0:l.name}),s.jsx("p",{className:"text-sm text-neutral-content",children:(c=t==null?void 0:t.createdAt)==null?void 0:c.split("T")[0]})]}),s.jsx(I,{rating:t==null?void 0:t.rating})]})]}),s.jsx("p",{className:"mt-2.5 text-sm text-neutral-content",children:t==null?void 0:t.description}),s.jsxs("div",{className:"absolute right-3 top-3 flex items-center gap-1",children:[s.jsx("button",{onClick:()=>_(t),className:"text-lg text-neutral-content duration-200 hover:text-primary",children:s.jsx(S,{})}),s.jsx(Q,{editModal:R,setEditModal:u,review:E}),s.jsx("button",{onClick:()=>y(t==null?void 0:t._id),className:"text-lg text-neutral-content duration-200 hover:text-primary",children:s.jsx(D,{})})]})]},t==null?void 0:t._id)}),x>1&&s.jsx("div",{className:"p-3",children:s.jsx(P,{setCurrentPage:N,currentPage:r,pages:x})})]})]})}export{H as default};
