import{p as u,as as ve,j as e,k as be,at as Ne,F as we,l as Se,r as Pe,m as he,y as ye,au as Te,av as Ie,aw as Oe,Q as h,n as Ce,o as fe,ax as Ee,ay as De,az as _e,aA as ke,aB as Me,s as Ve}from"./index-f981d823.js";import{u as Le}from"./couponApi-d935a6e5.js";import{P as qe,a as $e,C as Re,b as Fe,c as Ae}from"./calendar-917cd291.js";import{S as ge}from"./sweetalert2.esm.all-3fe0d2e9.js";import"./chevron-right-9544761f.js";function Ue({setShipping:i}){const[o,r]=u.useState(null),{data:a}=ve(),t=u.useMemo(()=>(a==null?void 0:a.data)||[],[a]);return u.useEffect(()=>{t.length>0&&!o&&(r(t[0].area),i(t[0].charge))},[t,o,i]),e.jsx("div",{className:"mt-4 space-y-3",children:t==null?void 0:t.map(n=>e.jsxs("label",{className:`flex cursor-pointer items-center gap-3 rounded-md border p-4 transition ${o===(n==null?void 0:n.area)?"border-blue-400 bg-blue-100":"border-gray-300 bg-white"}`,children:[e.jsx("input",{type:"radio",name:"delivery",value:n==null?void 0:n.area,checked:o===(n==null?void 0:n.area),onChange:()=>{r(n==null?void 0:n.area),i(n==null?void 0:n.charge)},className:"h-4 w-4 text-primary focus:ring-0"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-[17px] font-semibold",children:[n==null?void 0:n.charge," TK"]}),e.jsxs("span",{className:"ml-2 text-gray-600",children:[(n==null?void 0:n.area.charAt(0).toUpperCase())+(n==null?void 0:n.area.slice(1))," ",n==null?void 0:n.time]})]})]},n==null?void 0:n._id))})}function Be({setPaymentMethod:i}){const[o,r]=u.useState(null),a=u.useMemo(()=>[{_id:1,name:"Bkash"},{_id:2,name:"Card On Delivery"},{_id:3,name:"Cash on Delivery"},{_id:4,name:"SSL"}],[]);return u.useEffect(()=>{var t,n;(a==null?void 0:a.length)>0&&(r((t=a[0])==null?void 0:t._id),i((n=a[0])==null?void 0:n._id))},[a,i]),e.jsx("div",{className:"mt-4 space-y-3",children:a.map(t=>e.jsxs("label",{className:`flex cursor-pointer items-center gap-3 rounded-md border p-4 transition ${o===(t==null?void 0:t._id)?"border-blue-400 bg-blue-100":"border-gray-300 bg-white"}`,children:[e.jsx("input",{type:"radio",name:"payment",value:t==null?void 0:t._id,checked:o===(t==null?void 0:t._id),onChange:()=>{r(t==null?void 0:t._id),i(t==null?void 0:t._id),console.log("Payment method changed to:",t==null?void 0:t._id,t==null?void 0:t.name)},className:"h-4 w-4 text-primary focus:ring-0"}),e.jsx("div",{children:e.jsx("span",{className:"text-[15px] font-medium",children:t==null?void 0:t.name})})]},t==null?void 0:t._id))})}function We({product:i}){const o=be(),{_id:r,thumbnail:a,title:t,discount:n,price:x,quantity:b,sku:O,stock:C}=i,F=parseInt(x-x*n/100),N=parseInt(n>=1?F:x)*parseInt(b),V=(w,y)=>{window.confirm("Are you sure delete this item?")&&o(Pe({id:w,sku:y}))},k=(w,y)=>{C>b?o(he({id:w,sku:y,quantity:b+1})):ge.fire("","Sorry! We don't have enough stock","warning")},E=(w,y)=>{b>1?o(he({id:w,sku:y,quantity:b-1})):ge.fire("","Sorry! You can't decrease quantity. Minimum quantity is 1","warning")};return e.jsxs("div",{className:"border-b border-gray-100 py-3 pr-1 last:border-b-0",children:[e.jsxs("div",{className:"mb-1 flex items-start justify-between gap-2",children:[e.jsx("h4",{className:"flex-1 truncate text-sm font-medium text-gray-900",children:t}),e.jsx("button",{type:"button",onClick:()=>V(r,O),className:"flex-shrink-0 p-1 text-red-500 transition-colors hover:text-red-700",title:"Remove item",children:e.jsx(Ne,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:`https://api.torayvinobd.store/${a}`,alt:t,className:"h-16 w-16 flex-shrink-0 rounded-lg object-cover",loading:"lazy"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[O&&e.jsxs("p",{className:"text-xs text-gray-500",children:["SKU: ",O]}),e.jsx("div",{children:n>=1?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["à§³",F]}),e.jsxs("del",{className:"text-xs text-red-500",children:["à§³",x]})]}):e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["à§³",x]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Qty:"}),e.jsxs("div",{className:"flex items-center justify-center",children:[!(i!=null&&i.isBundleFree)&&e.jsx("button",{type:"button",onClick:()=>E(r,O),className:"text-gray-500 transition-colors hover:text-gray-700",children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center text-sm font-medium",children:b}),!(i!=null&&i.isBundleFree)&&e.jsx("button",{type:"button",onClick:()=>k(r,O),className:"text-gray-500 transition-colors hover:text-gray-700",children:e.jsx(Se,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"mb-1 text-xs text-gray-500",children:"Total"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["à§³",N]})]})]})]})}const pe=60,ze=10,Qe=({isOpen:i,onClose:o,onVerificationSuccess:r,redirectToCheckout:a=!1})=>{const t=ye(),[n,x]=u.useState(1),[b,O]=u.useState(""),[C,F]=u.useState(""),[N,V]=u.useState(""),[k,E]=u.useState(null),[w,y]=u.useState(null),[L,j]=u.useState(null),[W,M]=u.useState(0),[q,A]=u.useState(0),[H,{isLoading:J}]=Te(),[K,{isLoading:I}]=Ie(),[G,{isLoading:z}]=Oe(),S=J||I||z,P=u.useCallback(()=>{x(1),O(""),F(""),V(""),E(null),y(null),j(null),M(0),A(0),N&&(sessionStorage.removeItem(`otp_${N}`),sessionStorage.removeItem(`otp_expiry_${N}`)),o()},[N,o]);u.useEffect(()=>{let p;return i&&(k||w||L)&&(p=setInterval(()=>{const g=new Date().getTime();if(k){const m=Math.max(0,Math.floor((k-g)/1e3));M(m),m===0&&(h.error("OTP has expired. Please request a new one."),E(null),sessionStorage.removeItem(`otp_${N}`))}if(w){const m=Math.max(0,Math.floor((w-g)/1e3));A(m),m===0&&y(null)}L&&Math.floor((g-L)/6e4)>=ze&&(h.error("Verification session has expired. Please start again."),P())},1e3)),()=>{p&&clearInterval(p)}},[i,k,w,L,N,P]);const Q=async p=>{var g;if(p.preventDefault(),!b||b.length<10){h.error("Please enter a valid phone number");return}try{const m=await H({phoneNumber:b}).unwrap();if(m.success){const{verificationId:D,expiresAt:$,expiresIn:d,developmentOTP:s}=m.data;V(D),s&&(console.log("ðŸ”¢ [DEVELOPMENT] Your OTP is:",s),console.log("ðŸ†” [DEVELOPMENT] Verification ID:",D));const f=new Date().getTime();j(f);const v=new Date($).getTime();E(v);const _=new Date().getTime()+pe*1e3;y(_),x(2),h.success(`OTP sent to your phone number. Valid for ${Math.floor(d/60)} minutes.`)}}catch(m){h.error(((g=m==null?void 0:m.data)==null?void 0:g.message)||"Failed to send OTP. Please try again."),console.error("OTP sending error:",m)}},X=async p=>{var g;if(p.preventDefault(),!C||C.length!==6){h.error("Please enter a valid 6-digit OTP");return}try{const m=await K({phoneNumber:b,otpCode:C,verificationId:N}).unwrap();if(m.success){const{phoneNumber:D,tempToken:$,tempTokenExpiry:d}=m.data,s={phone:D,verified:!0,verificationTime:new Date().toISOString(),tempToken:$,tempTokenExpiry:d,isTemp:!0};sessionStorage.setItem("tempVerifiedUser",JSON.stringify(s)),h.success("Phone number verified successfully! You can now proceed with checkout."),a&&t("/checkout"),r(s),P()}}catch(m){const D=((g=m==null?void 0:m.data)==null?void 0:g.message)||"Failed to verify OTP. Please try again.";h.error(D),console.error("OTP verification error:",m)}},Z=async()=>{var p;if(q>0){h.error(`Please wait ${q} seconds before requesting a new OTP.`);return}try{const g=await G({verificationId:N}).unwrap();if(g.success){const{expiresAt:m,expiresIn:D,developmentOTP:$}=g.data;$&&(console.log("ðŸ”„ [DEVELOPMENT] Resend OTP is:",$),console.log("ðŸ†” [DEVELOPMENT] Verification ID:",N),console.log("â° [DEVELOPMENT] New expiry time:",new Date(m).toLocaleString()));const d=new Date(m).getTime();E(d);const s=new Date().getTime()+pe*1e3;y(s),h.success(`New OTP sent to your phone number. Valid for ${Math.floor(D/60)} minutes.`)}}catch(g){const m=((p=g==null?void 0:g.data)==null?void 0:p.message)||"Failed to resend OTP. Please try again.";h.error(m)}};return i?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:n===1?"Verify Phone Number":"Enter OTP"}),e.jsx("button",{onClick:P,className:"text-gray-500 hover:text-gray-700 text-2xl",disabled:S,children:"Ã—"})]}),n===1?e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),e.jsx("input",{type:"tel",value:b,onChange:p=>O(p.target.value),placeholder:"Enter your phone number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:S}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"We'll send you an OTP to verify your phone number"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:P,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",disabled:S,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:S,children:S?"Sending...":"Send OTP"})]})]}):e.jsxs("form",{onSubmit:X,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP *"}),e.jsx("input",{type:"text",value:C,onChange:p=>F(p.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit OTP",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-center text-lg tracking-widest",required:!0,disabled:S,maxLength:6}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["OTP sent to ",b]}),W>0&&e.jsxs("p",{className:"text-xs text-red-500",children:["Expires in ",Math.floor(W/60),":",String(W%60).padStart(2,"0")]})]})]}),e.jsx("div",{className:"mb-4 text-center",children:e.jsx("button",{type:"button",onClick:Z,className:`text-sm ${q>0?"text-gray-400 cursor-not-allowed":"text-blue-600 hover:text-blue-800"}`,disabled:S||q>0,children:q>0?`Resend OTP (${q}s)`:"Resend OTP"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>x(1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",disabled:S,children:"Back"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:S,children:S?"Verifying...":"Verify"})]})]})]})}):null},Ye=Qe,je=(i,o=24)=>{if(!i)return!1;const r=new Date(i);return(new Date-r)/(1e3*60*60)<o},Ke=()=>{const i=sessionStorage.getItem("tempVerifiedUser");if(i)try{const o=JSON.parse(i);je(o.verificationTime)||(sessionStorage.removeItem("tempVerifiedUser"),console.log("Expired temporary verification cleaned up"))}catch{sessionStorage.removeItem("tempVerifiedUser"),console.log("Corrupted verification data cleaned up")}Object.keys(sessionStorage).forEach(o=>{if(o.startsWith("otp_expiry_")){const r=parseInt(sessionStorage.getItem(o));if(new Date().getTime()>r){const t=o.replace("otp_expiry_","otp_");sessionStorage.removeItem(o),sessionStorage.removeItem(t),console.log(`Expired OTP cleaned up: ${t}`)}}else if(o.startsWith("otp_")&&!o.includes("expiry")){const r=o.replace("otp_","otp_expiry_");sessionStorage.getItem(r)||(sessionStorage.removeItem(o),console.log(`Orphaned OTP cleaned up: ${o}`))}})},He=i=>{if(i)return{...i,isLoggedIn:!0};const o=sessionStorage.getItem("tempVerifiedUser");if(o)try{const r=JSON.parse(o);if(je(r.verificationTime))return{...r,isLoggedIn:!1,isTemp:!0};sessionStorage.removeItem("tempVerifiedUser")}catch{sessionStorage.removeItem("tempVerifiedUser")}return null},Je=i=>i?i.startsWith("880")?`+${i.slice(0,3)} ${i.slice(3)}`:i.startsWith("01")?`+880 ${i}`:i:"";function ts(){Ce("Checkout");const i=ye(),o=be(),{loggedCustomer:r}=fe(d=>d.customer),a=fe(d=>d.cart.carts),[t,n]=u.useState(!1),[x,b]=u.useState(null),[O,C]=u.useState(!1);u.useEffect(()=>{(()=>{Ke();const s=He(r);s?(s.isTemp&&b(s),C(!0)):(C(!1),n(!0))})()},[r]),u.useEffect(()=>{if(window.scroll(0,0),(a==null?void 0:a.length)>0){const d=a==null?void 0:a.reduce((s,f)=>s+f.quantity*f.price,0);window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"begin_checkout",customer:{},ecommerce:{currency:"BDT",value:d,items:[a==null?void 0:a.map(s=>({item_id:s==null?void 0:s._id,item_name:s==null?void 0:s.title,price:(s==null?void 0:s.price)-(s==null?void 0:s.price)*parseInt(s==null?void 0:s.discount)/100,quantity:s==null?void 0:s.quantity,item_discount:parseInt(s==null?void 0:s.discount)}))]}})}},[a]);const[F,{isLoading:N}]=Le(),[V,k]=u.useState(""),[E,w]=u.useState(null),[y,L]=u.useState(0),[j,W]=u.useState(null),[M,q]=u.useState(0),[A,H]=u.useState(""),[J,K]=u.useState(""),[I,G]=u.useState("");u.useEffect(()=>{if(j){const d=a.map(f=>`${f._id}-${f.sku||""}-${f.quantity}`).sort().join("|"),s=sessionStorage.getItem("couponCartSignature");s?s!==d&&(L(0),W(null),w(null),sessionStorage.removeItem("couponCartSignature"),h.info("Coupon removed due to cart changes. Please reapply if needed.")):sessionStorage.setItem("couponCartSignature",d)}else sessionStorage.removeItem("couponCartSignature")},[a,j]);const z=a==null?void 0:a.reduce((d,s)=>d+s.quantity*parseInt(s.price-s.price*s.discount/100),0),S=0;let P=0;if(j&&y>0)if(j.isProduct&&j.eligibleProductIds){const d=new Set(j.eligibleProductIds.map(f=>String(f))),s=a.reduce((f,v)=>{if(d.has(String(v._id))){const _=v.price-v.price*v.discount/100;return f+v.quantity*_}return f},0);P=Math.round(s*y/100)}else P=Math.round((z+S)*y/100);const Q=z+S+parseInt(M)-P,X=async()=>{var f,v,_,R;const d={coupon:V,totalShopping:z,productIds:a.map(T=>T._id),items:a},s=await F(d);if(s!=null&&s.error?K((v=(f=s==null?void 0:s.error)==null?void 0:f.data)==null?void 0:v.message):K(""),(_=s==null?void 0:s.data)!=null&&_.success){const T=(R=s==null?void 0:s.data)==null?void 0:R.data;if(L(T==null?void 0:T.discount),W(T),w(V),T.isProduct&&T.eligibleProductIds){const U=T.eligibleProductIds.length;h.success(`Coupon applied to ${U} eligible product(s)`)}else h.success("Coupon applied to entire order");k("")}},[Z,{isLoading:p}]=Ee(),[g,{isLoading:m}]=De(),D=d=>{b(d),C(!0),n(!1),h.success("âœ… Phone verified! Complete your order below."),setTimeout(()=>{const s=document.querySelector("form");s&&s.scrollIntoView({behavior:"smooth",block:"start"})},500)},$=async d=>{var se,te,ae,ne,re,ie,le,oe,ce,de,ue,me;if(d.preventDefault(),console.log("Form submission started..."),M==0)return h.error("Please select shipping area");if(!I)return h.error("Please select a payment method");const s=d.target,f=s.name.value,v=s.number.value,_=s.email.value,R=s.fullAddress.value,T=s.note.value;if(!f||!v||!R)return h.error("Please fill in all required fields (Name, Phone, Address)");console.log("Validation passed, payment method:",I);const U=[],Y=[];a.forEach(l=>{l.type==="kit"?Y.push({kitId:l._id,discount:(l==null?void 0:l.discount)||0,quantity:l.quantity,price:l.price,isBundleFree:l.isBundleFree||!1}):U.push({productId:l._id,discount:(l==null?void 0:l.discount)||0,quantity:l.quantity,sku:l.sku,price:l.price,isBundleFree:l.isBundleFree||!1})});const ee={customer:{name:f,phone:v,email:_},shippingInfo:{address:R,note:T},paymentMethod:I,...U.length>0&&{products:U},...Y.length>0&&{kits:Y},totalPrice:Q,shippingCharge:M,couponCode:E,couponDiscount:P,couponEligibleProductIds:(j==null?void 0:j.eligibleProductIds)||[]};let B="";switch(I){case 1:B="bkash";break;case 2:B="cardondelivery";break;case 3:B="cashondelivery";break;case 4:B="ssl";break;default:B="cashondelivery"}if(ee.paymentMethod=B,I===2||I===3){const l=await Z(ee);(se=l==null?void 0:l.data)!=null&&se.success?(window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"purchase",customer:{name:f,phone:v,email:_,address:R,country:"Bangladesh"},ecommerce:{currency:"BDT",value:Q,shipping:M,transaction_id:(ae=(te=l==null?void 0:l.data)==null?void 0:te.data)==null?void 0:ae._id,items:[a==null?void 0:a.map(c=>({item_id:c==null?void 0:c._id,item_name:c==null?void 0:c.title,price:(c==null?void 0:c.price)-(c==null?void 0:c.price)*parseInt(c==null?void 0:c.discount)/100,quantity:c==null?void 0:c.quantity,item_discount:parseInt(c==null?void 0:c.discount)}))]}}),h.success("Order placed successfully"),o(Ve()),s.reset(),i(`/order/success/${(re=(ne=l==null?void 0:l.data)==null?void 0:ne.data)==null?void 0:re._id}`)):(h.error(((oe=(le=(ie=l==null?void 0:l.error)==null?void 0:ie.data)==null?void 0:le.error)==null?void 0:oe.length)>0&&((ue=(de=(ce=l==null?void 0:l.error)==null?void 0:ce.data)==null?void 0:de.error[0])==null?void 0:ue.message)||"Something Wrong"),console.log(l))}else if(I===1||I===4){const l={customer:{name:f,phone:v,email:_,address:R,country:"Bangladesh"},shippingInfo:{address:R||"",note:T||""},totalPrice:Number(Q)||0,shippingCharge:Number(M)||0,...U.length>0&&{products:U},...Y.length>0&&{kits:Y},paymentMethod:B,currency:"BDT",couponCode:E,couponDiscount:P,couponEligibleProductIds:(j==null?void 0:j.eligibleProductIds)||[]};console.log("Sending payment data:",l);try{const c=await g(l);if(console.log("Payment response:",c.data.data.data),(me=c==null?void 0:c.data)!=null&&me.success){const xe=c.data.data.paymentUrl||c.data.data.data.bkashURL;xe?window.location.href=xe:h.error("No payment URL received")}else h.error("Failed to initialize payment"),console.error("Payment failed:",(c==null?void 0:c.error)||c)}catch(c){h.error("Payment initialization failed"),console.error("Payment error:",c)}}else h.error("Please select a valid payment method"),console.error("Unrecognized payment method:",I)};return O?e.jsx("div",{className:"pt-5",children:e.jsxs("div",{className:"container",children:[x&&!r&&e.jsx("div",{className:"mb-4 rounded-md border border-blue-200 bg-blue-100 p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["âœ“ Phone number verified:"," ",Je(x.phone)]})}),e.jsxs("form",{onSubmit:$,className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"rounded border bg-base-100 p-4 shadow",children:e.jsxs("div",{children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold uppercase",children:"Shipping Details"}),e.jsxs("div",{className:"grid gap-4 text-sm md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Full Name *"}),e.jsx("input",{type:"text",name:"name",className:"mt-2 w-full rounded border-2 p-2 outline-none",required:!0,defaultValue:(r==null?void 0:r.name)||(x==null?void 0:x.name)||""})]}),e.jsxs("div",{children:[e.jsx("h3",{children:"Phone *"}),e.jsx("input",{type:"number",name:"number",className:`mt-2 w-full rounded border-2 p-2 outline-none ${x&&!r?"border-green-300 bg-green-50":""}`,required:!0,defaultValue:(r==null?void 0:r.phone)||(x==null?void 0:x.phone)||"",readOnly:!!x&&!r}),!!x&&!r&&e.jsx("p",{className:"mt-1 text-xs text-green-600",children:"âœ“ Verified"})]})]}),e.jsx("div",{className:"mt-2 text-sm",children:e.jsxs("div",{children:[e.jsx("h3",{children:"Email Address"}),e.jsx("input",{type:"email",name:"email",className:"mt-2 w-full rounded border-2 p-2 outline-none",defaultValue:(r==null?void 0:r.email)||(x==null?void 0:x.email)||""})]})}),e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("h3",{children:"Full Address *"}),e.jsx("textarea",{name:"fullAddress",rows:"3",placeholder:"House number and Full Address",className:"mt-2 w-full rounded border-2 p-2 outline-none",required:!0,defaultValue:(r==null?void 0:r.address)||(x==null?void 0:x.address)||""})]})]})}),e.jsxs("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"rounded border bg-base-100 p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral",children:"Payment Method"}),e.jsx(Be,{setPaymentMethod:G})]}),e.jsxs("div",{className:"rounded border bg-base-100 p-4 shadow",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral",children:"Shipping Method"}),e.jsx(Ue,{setShipping:q}),e.jsx("div",{className:"mt-4",children:e.jsxs(qe,{children:[e.jsx($e,{asChild:!0,children:e.jsxs("button",{className:_e("flex w-full justify-between rounded border border-primary px-3 py-2 text-left font-normal",!A&&"text-muted-foreground"),children:[A?ke(A,"PPP"):e.jsx("span",{className:"text-sm",children:"Select Delivery Date"}),e.jsx(Re,{className:"ml-2 h-5 w-5 text-blue-900"})]})}),e.jsx(Fe,{className:"w-auto p-0",align:"start",children:e.jsx(Ae,{mode:"single",selected:A,onSelect:H,initialFocus:!0})})]})}),e.jsx("div",{className:"mt-4",children:e.jsx("textarea",{name:"note",rows:"4",placeholder:"Add Delivery Instruction",className:"mt-2 w-full rounded border border-primary p-2 outline-none"})})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"checkout-output relative mb-4 rounded border bg-base-100 p-4",children:[e.jsxs("h3",{className:"mb-4 text-xl font-medium text-neutral",children:["Your Order (",a==null?void 0:a.length," items)"]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:a==null?void 0:a.map(d=>e.jsx(We,{product:d},`${d._id}-${d.sku}`))})]}),e.jsxs("div",{className:"checkout-output relative rounded border bg-base-100 p-4",children:[e.jsxs("div",{className:"mb-4 border-b pb-4",children:[e.jsx("h3",{className:"text-[17px] font-medium text-neutral",children:"Discounts"}),e.jsxs("div",{children:[e.jsx("small",{className:"text-xs text-neutral-content",children:"REFERRAL OR PROMO CODE"}),e.jsxs("div",{className:"flex items-center gap-px",children:[e.jsx("input",{onChange:d=>k(d.target.value),type:"text",className:"w-full rounded border px-3 py-[7px] text-sm outline-none",placeholder:"Enter Code",value:V}),e.jsx("div",{onClick:X,className:"primary_btn cursor-pointer",style:{fontSize:"13px"},disabled:N&&"disabled",children:N?"Loading...":"Apply"})]}),y>0&&e.jsxs("p",{className:"text-xs text-green-500",children:['âœ“ Coupon "',E,'" applied successfully! You have saved à§³',P,"."]}),e.jsx("p",{className:"text-xs text-red-500",children:J})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-medium text-neutral",children:"Order Summary"}),e.jsxs("div",{className:"flex justify-between border-b py-1.5 text-sm",children:[e.jsx("h3",{children:"Subtotal"}),e.jsxs("p",{children:["à§³",e.jsxs("span",{children:[z,".00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-b py-1.5 text-sm",children:[e.jsx("h3",{children:"Shipping Charge"}),e.jsxs("div",{className:"text-end",children:["à§³",e.jsxs("span",{children:[M,".00"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between border-b py-1.5 text-sm text-red-500",children:[e.jsx("h3",{children:"Discount"}),e.jsxs("div",{className:"text-end",children:["- à§³",e.jsxs("span",{children:[P,".00"]})]})]}),e.jsxs("div",{className:"flex justify-between border-b py-2 text-lg font-medium",children:[e.jsx("h3",{className:"text-title",children:"Total"}),e.jsxs("p",{className:"text-primary",children:["à§³ ",e.jsxs("span",{children:[Q,".00 "]})]})]})]}),e.jsx("button",{type:"submit",disabled:p||m,className:"flex w-full justify-center rounded bg-primary py-2 text-base-100 shadow disabled:opacity-50",onClick:()=>console.log("Submit button clicked!"),children:p||m?e.jsx(Me,{}):"PLACE ORDER"})]})]})]}),e.jsx("div",{className:"flex justify-end"})]})}):e.jsxs("div",{className:"pt-5",children:[e.jsx("div",{className:"container",children:e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("h2",{className:"mb-4 text-2xl font-semibold",children:"Phone Verification Required"}),e.jsx("p",{className:"mb-8 text-gray-600",children:"Please verify your phone number to proceed with checkout."})]})}),e.jsx(Ye,{isOpen:t,onClose:()=>i(-1),onVerificationSuccess:D})]})}export{ts as default};
