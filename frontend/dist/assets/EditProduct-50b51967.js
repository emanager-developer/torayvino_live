import{u as Ie,y as Me,p as a,cf as Te,c7 as Ve,c8 as Ge,Z as Re,cg as ze,j as e,c9 as Fe,Q as u}from"./index-f981d823.js";import{T as He,G as Ue,P as Ke,a as Le,V as Je,F as Oe,D as Ze}from"./Details-99f280bf.js";import{B as We}from"./Bundle-ce039579.js";import"./brandApi-d50b0447.js";import"./subCategoryApi-75905068.js";import"./subSubCategoryApi-83220bb9.js";import"./colorApi-fead5e16.js";function rs(){var Ne,ve;const{id:J}=Ie(),Pe=Me(),[O,Z]=a.useState([]),[h,qe]=a.useState([]),[W,X]=a.useState([]),[d,Q]=a.useState([]),[D,Y]=a.useState(""),[A,ee]=a.useState(null),[B,se]=a.useState(null),[$,te]=a.useState(null),[ae,le]=a.useState(null),[E,I]=a.useState(0),[M,T]=a.useState(0),[Qe,re]=a.useState(0),[ie,ne]=a.useState(!1),[V,de]=a.useState(""),[ce,oe]=a.useState(""),[b,ue]=a.useState(!1),[o,me]=a.useState([]),[g,De]=a.useState([]),[m,f]=a.useState([{title:"",description:""}]),[p,G]=a.useState([]),[j,R]=a.useState([]),[x,y]=a.useState([{question:"",answer:""}]),[xe,he]=a.useState(""),[N,z]=a.useState([]),[_,be]=a.useState(!1),[ge,fe]=a.useState(0),[pe,je]=a.useState(0),{data:k}=Te(J),s=a.useMemo(()=>(k==null?void 0:k.data)||{},[k]),{data:H}=Ve(),{data:U}=Ge(),{data:K}=Re(),F=(H==null?void 0:H.data)||[],P=(U==null?void 0:U.data)||[],q=(K==null?void 0:K.data)||[];a.useEffect(()=>{var t,i,r,l,v,w,S,C;s&&(Z(s!=null&&s.thumbnail?[{data_url:`https://api.torayvinobd.store/${s.thumbnail}`}]:[]),X(s==null?void 0:s.galleries),Y((s==null?void 0:s.title)||""),se(((t=s==null?void 0:s.category)==null?void 0:t._id)??(s==null?void 0:s.category)??""),te(((i=s==null?void 0:s.subCategory)==null?void 0:i._id)??(s==null?void 0:s.subCategory)??""),ee(((r=s==null?void 0:s.subSubCategory)==null?void 0:r._id)??(s==null?void 0:s.subSubCategory)??""),le((s==null?void 0:s.brand)||null),I((s==null?void 0:s.price)||0),T((s==null?void 0:s.stock)||0),re((s==null?void 0:s.discount)||0),ne((s==null?void 0:s.featured)||!1),de((s==null?void 0:s.description)||""),oe(Array.isArray(s==null?void 0:s.tags)?s==null?void 0:s.tags.join("; "):(s==null?void 0:s.tags)||""),ue((s==null?void 0:s.isVariant)||!1),me((s==null?void 0:s.variants)||[]),f(((l=s==null?void 0:s.specifications)==null?void 0:l.length)>0?s.specifications:[{title:"",description:""}]),G(((v=s==null?void 0:s.feature)==null?void 0:v.map(c=>c._id||c))||[]),R(((w=s==null?void 0:s.shortFeature)==null?void 0:w.map(c=>c._id||c))||[]),y(((S=s==null?void 0:s.faq)==null?void 0:S.length)>0?s.faq:[{question:"",answer:""}]),he((s==null?void 0:s.disclaimer)||""),z(((C=s==null?void 0:s.kits)==null?void 0:C.map(c=>c._id||c))||[]),be((s==null?void 0:s.isBundle)||!1),fe((s==null?void 0:s.bundlePurchaseQuantity)||0),je((s==null?void 0:s.bundleQuantity)||0),s!=null&&s.productManual&&Q([{name:"Current Manual",url:`https://api.torayvinobd.store${s.productManual}`}]))},[s]),a.useEffect(()=>{var t;b&&(o==null?void 0:o.length)>0&&(I(((t=o[0])==null?void 0:t.price)||0),T(o==null?void 0:o.reduce((i,r)=>i+(Number(r.stock)||0),0)))},[b,o]);const[Ae,{isLoading:ye}]=ze(),Be=async t=>{var v,w,S,C,c,we,Se,Ce,_e,ke;if(t.preventDefault(),!D)return u.warning("Title is required");if(!B)return u.warning("Category is required");if(!E)return u.warning("Price is required");if(!M)return u.warning("Stock is required");if(!V)return u.warning("Description is required");const i={title:D,brand:ae,price:E,stock:M,discount:Qe,featured:ie,description:V,isVariant:b,variants:o,tags:ce,galleriesUrl:W,specifications:m.filter(n=>n.title&&n.description),feature:p,shortFeature:j,faq:x.filter(n=>n.question&&n.answer),disclaimer:xe,kits:N,isBundle:_,bundlePurchaseQuantity:_?ge:0,bundleQuantity:_?pe:0};i.category=B,$&&(i.subCategory=$),A&&(i.subSubCategory=A);const r=new FormData;r.append("thumbnail",(v=O[0])==null?void 0:v.file),(h==null?void 0:h.length)>0&&h.forEach(n=>r.append("gallery",n.file)),(d==null?void 0:d.length)>0&&((w=d[0])!=null&&w.file)&&r.append("productManual",(S=d[0])==null?void 0:S.file),(g==null?void 0:g.length)>0&&g.forEach((n,$e)=>{if((n==null?void 0:n.length)>0){const L=n[0].file,Ee=new File([L],`variant-${$e}-${L.name}`,{type:L.type});r.append("variantImages",Ee)}}),r.append("data",JSON.stringify(i));const l=await Ae({id:J,formData:r});(C=l==null?void 0:l.data)!=null&&C.success?(u.success("Product updated successfully"),Pe("/admin/product/all-products")):(u.error(((Se=(we=(c=l==null?void 0:l.error)==null?void 0:c.data)==null?void 0:we.error)==null?void 0:Se.length)>0?(ke=(_e=(Ce=l==null?void 0:l.error)==null?void 0:Ce.data)==null?void 0:_e.error[0])==null?void 0:ke.message:"Failed to update product"),console.log(l))};return e.jsxs("div",{className:"add_product rounded bg-base-100 shadow",children:[e.jsx("h3",{className:"border-b p-4 text-lg font-medium text-neutral",children:"Edit Product"}),e.jsxs("div",{className:"p-3 text-neutral-content",children:[e.jsx(He,{thumbnail:O,setThumbnail:Z}),e.jsx(Ue,{galleries:h,setGalleries:qe,galleriesUrl:W,setGalleriesUrl:X}),e.jsxs("div",{className:"form_group mt-3",children:[e.jsx(Ke,{title:D,setTitle:Y,categoryId:B,setCategoryId:se,subCategoryId:$,setSubCategoryId:te,subSubCategoryId:A,setSubSubCategoryId:ee,brand:ae,setBrand:le}),e.jsx(Le,{price:E,setPrice:I,setDiscount:re,stock:M,setStock:T,isVariant:b}),e.jsx(Je,{isVariant:b,setIsVariant:ue,variants:o,setVariants:me,variantImages:g,setVariantImages:De}),e.jsx(Oe,{featured:ie,setFeatured:ne}),e.jsx(We,{isBundle:_,setIsBundle:be,bundlePurchaseQuantity:ge,setBundlePurchaseQuantity:fe,bundleQuantity:pe,setBundleQuantity:je}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("label",{className:"mb-2 block text-sm",children:["Tags ",e.jsx("small",{children:"(; separated)"})]}),e.jsx("textarea",{value:ce,onChange:t=>oe(t.target.value),placeholder:"Enter tags separated by semicolons (;)",className:"w-full rounded border p-2",rows:5})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("p",{className:"mb-2 text-sm",children:"Product Manual (PDF)"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 rounded border border-dashed p-3",children:[e.jsx("input",{type:"file",accept:".pdf",onChange:t=>{t.target.files&&t.target.files[0]&&Q([{file:t.target.files[0],name:t.target.files[0].name}])},className:"hidden",id:"pdf-upload"}),e.jsx("label",{htmlFor:"pdf-upload",className:"cursor-pointer rounded-2xl bg-primary px-4 py-1.5 text-sm text-base-100",children:"Choose PDF File"}),e.jsx("p",{className:"text-neutral-content",children:"or Drop PDF here"})]}),e.jsx("div",{className:"rounded border border-dashed p-3",children:(d==null?void 0:d.length)>0?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-6 w-6 text-red-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-sm text-neutral-content",children:(Ne=d[0])==null?void 0:Ne.name})]}),e.jsxs("div",{className:"flex gap-2",children:[((ve=d[0])==null?void 0:ve.url)&&e.jsx("a",{href:d[0].url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700",children:e.jsxs("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),e.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})}),e.jsx("button",{type:"button",onClick:()=>Q([]),className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}):e.jsx("p",{className:"text-center text-gray-400",children:"No PDF selected"})})]})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Features"}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[p.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg p-3 bg-gray-50",children:(F==null?void 0:F.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:F.map(t=>e.jsxs("div",{className:"flex items-center p-2 bg-white rounded border hover:bg-blue-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:`feature-${t._id}`,checked:p.includes(t._id),onChange:i=>{i.target.checked?G([...p,t._id]):G(p.filter(r=>r!==t._id))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 mr-3"}),e.jsx("label",{htmlFor:`feature-${t._id}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t.name||t.title})]},t._id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No features available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Short Features"}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[j.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg p-3 bg-gray-50",children:(P==null?void 0:P.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:P.map(t=>e.jsxs("div",{className:"flex items-center p-2 bg-white rounded border hover:bg-green-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:`shortFeature-${t._id}`,checked:j.includes(t._id),onChange:i=>{i.target.checked?R([...j,t._id]):R(j.filter(r=>r!==t._id))},className:"h-4 w-4 text-green-600 border-gray-300 rounded focus:ring-green-500 mr-3"}),e.jsx("label",{htmlFor:`shortFeature-${t._id}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t.name||t.title})]},t._id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No short features available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Related Kits"}),e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[N.length," selected"]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto border rounded-lg p-3 bg-gray-50",children:(q==null?void 0:q.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:q.map(t=>e.jsxs("div",{className:"flex items-center p-2 bg-white rounded border hover:bg-purple-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:`kit-${t._id}`,checked:N.includes(t._id),onChange:i=>{i.target.checked?z([...N,t._id]):z(N.filter(r=>r!==t._id))},className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500 mr-3"}),e.jsx("label",{htmlFor:`kit-${t._id}`,className:"text-sm text-gray-700 cursor-pointer flex-1",children:t.name})]},t._id))}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"No kits available"})})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Specifications"}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{className:"mb-1 ml-2 block w-[48%] text-sm font-medium text-gray-700",children:"Title"}),e.jsx("label",{className:"mb-1 block w-[50%] text-sm font-medium text-gray-700",children:"Description"})]}),m.map((t,i)=>e.jsxs("div",{className:"mb-3 flex gap-3 rounded border p-3",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{children:e.jsx("textarea",{placeholder:"Specification Title",value:t.title,onChange:r=>{const l=[...m];l[i].title=r.target.value,f(l)},className:"w-full rounded border p-2",rows:2})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:"Specification Description",value:t.description,onChange:r=>{const l=[...m];l[i].description=r.target.value,f(l)},className:"w-full rounded border p-2",rows:2})})]}),e.jsx("button",{type:"button",onClick:()=>{f(m.filter((r,l)=>l!==i))},className:"text-red-500 hover:text-red-700",children:e.jsx(Fe,{className:"h-7 w-7"})})]},i)),e.jsx("button",{type:"button",onClick:()=>f([...m,{title:"",description:""}]),className:"mt-2 rounded bg-blue-500 px-3 py-1 text-white",children:"Add Specification"})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"FAQ"}),e.jsxs("div",{className:"flex w-full",children:[e.jsx("label",{className:"mb-1 ml-2 block w-[48%] text-sm font-medium text-gray-700",children:"Question"}),e.jsx("label",{className:"mb-1 block w-[50%] text-sm font-medium text-gray-700",children:"Answer"})]}),x.map((t,i)=>e.jsxs("div",{className:"mb-3 flex gap-3 rounded border p-3",children:[e.jsxs("div",{className:"grid flex-1 grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsx("div",{children:e.jsx("textarea",{placeholder:"Question",value:t.question,onChange:r=>{const l=[...x];l[i].question=r.target.value,y(l)},className:"w-full rounded border p-2",rows:2})}),e.jsx("div",{children:e.jsx("textarea",{placeholder:"Answer",value:t.answer,onChange:r=>{const l=[...x];l[i].answer=r.target.value,y(l)},className:"w-full rounded border p-2",rows:2})})]}),e.jsx("button",{type:"button",onClick:()=>{y(x.filter((r,l)=>l!==i))},className:"text-red-500 hover:text-red-700",children:e.jsx(Fe,{className:"h-7 w-7"})})]},i)),e.jsx("button",{type:"button",onClick:()=>y([...x,{question:"",answer:""}]),className:"mt-2 rounded bg-blue-500 px-3 py-1 text-white",children:"Add FAQ"})]}),e.jsxs("div",{className:"mt-3 rounded border p-4",children:[e.jsx("label",{className:"mb-2 block text-sm",children:"Disclaimer"}),e.jsx("textarea",{value:xe,onChange:t=>he(t.target.value),placeholder:"Enter product disclaimer",className:"w-full rounded border p-2",rows:4})]}),e.jsx(Ze,{details:V,setDetails:de}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:Be,type:"submit",disabled:ye,className:"rounded bg-primary px-10 py-2 text-base-100",children:ye?"Loading...":"Edit Product"})})]})]})]})}export{rs as default};
